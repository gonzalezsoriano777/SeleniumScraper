webpackJsonp([112],{1689:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),a=n.n(s),i=n(1),r=n.n(i),c=n(3),o=n.n(c),l=n(4),u=n.n(l),h=n(80),p=n.n(h),d=n(2),m=n.n(d),g=n(24),f=n.n(g);var C=function(e,t,n){var s="https://www.yahoo.com/",a={protocol:n||"https",host:t||"www.yahoo.com"};if(e)if(e.url){var i=f.a.parse(e.url,!0);i=Object.assign(i,a),s=f.a.format(i)}else s=f.a.format(a);return s},v=n(154),S=n.n(v),_=n(645),A=n.n(_),U=n(259),y=n.n(U),b=n(208),E=n.n(b),w=n(358),R=n.n(w),N=n(376),T=n.n(N),I=n(33),O=n.n(I);const k=p()("account-switch:mixins:StyleMergeMixin");var H={getInitialState:function(){var e=this.props.componentConfig||{},t=Object.assign({},e.styles,this.props.styles);return k(t),{styles:t}}},x=n(27),M=n.n(x),q=n(401),F=n.n(q);const j=p()("account-switch:stores:UHAccountSwitchStore");var z=function(e){return["true",!0,"1",1].indexOf(e)>-1},P=M()({storeName:"UHAccountSwitchStore",initialize:function(){this.state={site:"fpctx"}},statics:{handlers:{NAVIGATE_SUCCESS:"_handleNavSuccess",ACCOUNT_SWITCH_INIT:"initializeState",FETCH_ACCOUNT_SWITCH_START:"sendRequest",FETCH_ACCOUNT_SWITCH_SUCCESS:"receiveAccountData",FETCH_ACCOUNT_SWITCH_FAILURE:"handleError",FETCH_ACCOUNT_SWITCH_CRUMB_SUCCESS:"receiveCrumb"}},_handleNavSuccess:function(e){var t,n=e&&e.route?e.route:e;return j("_handleNavSuccess","payload",e),(t=m()(n,["params","contentSite"]))||(t=m()(n,["contentSite"])),t||(t=m()(n,["query","site"])),t||(t=m()(this.state,["site"],null)),t||(t="fpctx"),j("_handleNavSuccess","site",t),this.state.site!==t&&(this.state.site=t,this.emitChange(),!0)},receiveAccountData:function(e){"string"==typeof e&&(e=F()(e));var t=e.users;this.state.users=t,this.state.isFetching=!1,this.state.accountsReceived=!0,this.state.sendRequest=!1,this.emitChange()},receiveCrumb:function(e){j("receiveCrumb",e),e.accountSwitchCrumb&&(this.state.crumb=e.accountSwitchCrumb,this.emitChange())},sendRequest:function(){this.getIsFetching()||!this.getCrumb()||this.getAccountsReceived()||this.getSendRequest()||(this.state.sendRequest=!0,this.state.isFetching=!0,this.emitChange())},handleError:function(){this.state.isFetching=!1,this.state.error=!0,this.state.accountsReceived=!0,this.emitChange()},initializeState:function(e){j("initializeState: ",e);var t=e.config||{},n=t.sendRequest;n=z(n);var s=t.isEnabled;s=z(s),j("sendRequest: ",n),this.state.sendRequest=n,this.state.isEnabled=s,this.emitChange(),j("state",this.state)},getUsers:function(){return this.state.users},getIsEnabled:function(){return z(this.state.isEnabled)},getIsFetching:function(){return this.state.isFetching},getError:function(){return this.state.error},getSendRequest:function(){return this.state.sendRequest},getCrumb:function(){return this.state.crumb},getAccountsReceived:function(){return this.state.accountsReceived},getSite:function(){return this.state.site},dehydrate:function(){return this.state},rehydrate:function(e){return this.state.site=e&&e.site?e.site:this.state.site,this.state.crumb=e&&e.crumb?e.crumb:this.state.crumb,this.state.sendRequest=e&&e.sendRequest?e.sendRequest:this.state.sendRequest,this.state.isEnabled=e&&e.isEnabled?e.isEnabled:this.state.isEnabled,this}});const W=p()("account-switch:actions:fetchAccountSwitchCrumbs");var L=function(e,t,n){var s=e.getStore(P).getCrumb();if(s&&"undefined"!==s)return n&&n();e.dispatch("FETCH_ACCOUNT_SWITCH_CRUMB_START"),e.service.read("AccountSwitchCrumbService",{},{},function(t,s){return W("UHCrumbs data",s),t||!s?(e.dispatch("FETCH_ACCOUNT_SWITCH_CRUMB_FAIL",t),n(t,null)):(e.dispatch("FETCH_ACCOUNT_SWITCH_CRUMB_SUCCESS",{accountSwitchCrumb:encodeURIComponent(s.accountSwitchCrumb)}),n&&n())})};const D=p()("account-switch:actions:initAccountSwitch");var B=function(e,t,n){var s=m()(t,["componentProps","componentConfig"],{});if("undefined"==typeof window&&"client"===s.mode)return e.dispatch("ACCOUNT_SWITCH_INIT",{config:s}),n&&n();e.executeAction(L,t,function(t){if(t)return D("error fetching crumb"),n&&n(t);var a={config:s};return D("data: ",a),e.dispatch("ACCOUNT_SWITCH_INIT",a),n&&n()})},G=n(694),Y=n(669),$=n.n(Y);const Q=p()("account-switch:actions:fetchAccounts");var V=!1;var Z=function(e,t,n){var s=e.getStore("UHAccountSwitchStore"),a=e.getStore("UserStore"),i=t.requestUrl,r=a.isSignedIn()||a.isRecognized();if(!V&&s.getIsEnabled()&&r&&!s.getAccountsReceived()&&i){Q("fetching account switch accounts"),V=!0;var c=t.timeout||3e3;$()(i,{timeout:c,name:"processDeviceUsers"},function(t,s){s&&e?e.dispatch("FETCH_ACCOUNT_SWITCH_SUCCESS",s):e.dispatch("FETCH_ACCOUNT_SWITCH_FAILURE"),n&&n()})}else Q("skipping account fetch"),n&&n()},J=n(251),K=n.n(J),X=n(11),ee=n(360),te=n.n(ee),ne=n(20),se=n(670),ae=n.n(se),ie=n(57),re=n.n(ie),ce=/(profile_|39361574426_98028a_)/,oe=o()({displayName:"Avatar",mixins:[re.a],propTypes:{src:a.a.string,size:a.a.number,name:a.a.string,enableAlphatar:a.a.bool},getDefaultProps:function(){return{src:"",size:34,name:"",enableAlphatar:!1}},render:function(){var e,t=this.props.src,n=this.props.size,s=this.props.name,a=m()(this.props,["styles","avatar"],{}),i=a.iconStyle||{},c=a.imgStyle||{},o=this.props.color||a.color;if(!t||ce.test(t)){t=null;var l=s?s.toUpperCase().charCodeAt(0):null;l=l&&l>=65&&l<=90?String.fromCharCode(l):null,this.props.enableAlphatar&&l&&(t="https://s.yimg.com/rz/uh/alphatars/"+l+".png"),t||(e=r.a.createElement(X.Icon,{asset:ae.a,height:n,color:o,style:i}))}return t&&(s&&s.match(/@yahoo-inc.com/gi)&&(t="https://backyard.yahoo.com/isweb-icons/staff/"+s.replace("@yahoo-inc.com","")+"_square.jpg"),c=Object.assign(c,{backgroundImage:"url("+t+")",backgroundSize:"cover",borderRadius:n,height:n,width:n}),e=r.a.createElement("i",{className:a.content,style:c})),e}}),le=n(19),ue=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},he=o()({displayName:"UserInfo",mixins:[re.a],propTypes:{avatarColor:a.a.string,avatarSize:a.a.number,children:a.a.element,fn:a.a.string,ln:a.a.string,alias:a.a.string,em:a.a.string,imageUrl:a.a.string,style:a.a.object,useWelcome:a.a.bool},getDefaultProps:function(){return{avatarSize:40,fn:"",ln:"",alias:"",em:"",imageUrl:"",useWelcome:!1}},contextTypes:{enableAlphatar:a.a.bool},render:function(){var e=m()(this.props,["styles"],{}),t=e.main_account,n=this.props.fn,s=this.props.ln,a=n&&s?n+" "+s:n||null,i={color:this.props.avatarColor,enableAlphatar:this.context.enableAlphatar,name:a,size:e.avatar.size||this.props.avatarSize,src:this.props.imageUrl},c=this.props.em||this.props.alias||null;a||c||!this.props.useWelcome||(a=r.a.createElement(le.FormattedMessage,{id:"WELCOME"}));var o=a&&c?null:{lineHeight:i.size+"px"},l=a?r.a.createElement("div",{style:o,className:t.name},a):null,u=c?r.a.createElement("div",{style:o,className:t.alias},c):null;return r.a.createElement("div",{className:t.wrapper},r.a.createElement("div",{className:e.avatar.wrapper},r.a.createElement(oe,ue({},i,{styles:e}))),r.a.createElement("div",{className:t.user_info_wrapper},l,u),this.props.children)}}),pe=n(146),de=n.n(pe),me=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e};const ge=p()("account-switch:components:SecondaryAccounts");var fe=o()({displayName:"SecondaryAccounts",autobind:!1,mixins:[re.a],propTypes:{accounts:a.a.array,createClickHandler:a.a.func,getUrl:a.a.func},componentWillUnmount:function(){this.navTimer&&(clearTimeout(this.navTimer),this.navTimer=null)},render:function(){var e=this.props,t=e.accounts,n=m()(e,["styles","secondary_accounts"],{}),s=n.list_item,a=n.anchor,i=n.avatarColor;ge("render SecondaryAccounts"),ge(t);var c=y.a.secondaryAccounts,o=de()(t,function(t,n){var o=e.createClickHandler(function(n){return e.getUrl("switchUrl",t,!0)});return r.a.createElement("li",{key:t.alias,className:s},r.a.createElement(ne.I13nAnchor,{onClick:o,className:a,follow:!1,href:e.getUrl("switchUrl",t),i13nModel:Object.assign({},c,{cpos:n+1})},r.a.createElement(he,me({avatarColor:i},t,{styles:e.styles}))))});return r.a.createElement("ul",{className:n.list},o)}}),Ce=o()({displayName:"AddAccounts",mixins:[re.a],propTypes:{i13n:a.a.object,defaultStyle:a.a.object,manageUrl:a.a.string,onClick:a.a.func,textId:a.a.string},getDefaultProps:function(){return{hasAccounts:!1,manageUrl:""}},render:function(){var e=m()(this.props,["styles","add_accounts"],{}),t=u()(e.wrapper,"acct-switch-manage");return r.a.createElement(ne.I13nAnchor,{onClick:this.props.onClick,className:t,href:this.props.manageUrl,i13nModel:y.a.addAccount},r.a.createElement("div",{className:e.icon_wrapper},r.a.createElement("i",{className:e.icon_content},"+")),r.a.createElement("span",{className:e.text},r.a.createElement(le.FormattedMessage,{id:this.props.textId})))}}),ve=n(92),Se=n.n(ve),_e=n(362),Ae=n.n(_e),Ue=n(25),ye=n.n(Ue),be=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e};const Ee=p()("account-switch:component:AccountSwitch");var we="undefined"!=typeof window,Re=/\{([\s\S]+?)\}/;const Ne={AccountSwitch:o()({mixins:[O.a,H],statics:{componentConfig:{name:"componentAccountSwitch"},initializeAction:B,storeListeners:[Se.a,Ae.a,P]},displayName:"AccountSwitch",propTypes:{accountInfoLink:a.a.element,extraAccountInfoComponent:a.a.oneOfType([a.a.node,a.a.func,a.a.object]),componentConfig:a.a.object,notifications:a.a.element},contextTypes:{session:a.a.object},childContextTypes:{enableAlphatar:a.a.bool},getChildContext:function(){var e=m()(this.props,["componentConfig","enableAlphatar"],!1);return{enableAlphatar:["true","1",!0,1].indexOf(e)>-1&&this.state.accountsReceived}},getInitialState:function(){this.UHAccountSwitchStore=this.getStore(P),this.UserStore=this.getStore(Se.a),this.ProfileStore=this.getStore(Ae.a),this.RouteStore=this.getStore(ye.a),this.replacements=E()(this.context.session.dimensions,["intl","lang","partner","site"]);var e=this._getState();return Ee("initial state",e),e},shouldComponentUpdate:function(e,t){var n=this.state.mainAccountReceived!==t.mainAccountReceived||this.state.accountsReceived!==t.accountsReceived||this.state.menuOpen!==t.menuOpen||this.state.site!==t.site||this.props.notifications!==e.notifications;return Ee("shouldComponentUpdate: ",n),n},componentWillMount:function(){var e=this;e.addAccountsClickHandler=e._createClickHandler(function(){return e._getUrl("manageUrl",null,!0)}),e.signoutClickHandler=e._createClickHandler(function(){return e._getUrl("logoutUrl",null,!0)})},componentDidMount:function(){Ee("componentDidMount: ",this.props),!(this.props.componentConfig||{}).isEnabled||this.state.isFetching||this.state.accountsReceived||this.executeAction(B,{componentProps:{componentConfig:{isEnabled:!0,sendRequest:!0}}}),this.state.sendRequest&&this._sendRequest(),this.UserStore.isLoaded()||this.executeAction(K.a,{})},onChange:function(){!this.UHAccountSwitchStore.getSendRequest()||this.state.isFetching||this.state.accountsReceived||this._sendRequest(),this.setState(this._getState())},_shouldRender:function(){var e=this.props.componentConfig||{},t=this.state.accountsReceived||this.state.sendRequest;return e.isEnabled&&(!e.clientRender||we&&t)},render:function(){if(!this._shouldRender())return null;Ee("render AccountSwitch",this.props),Ee("state: ",this.state);var e,t=this.state.styles,n=this._isDesktop(),s=this._getMainAccountNode(),a=this.secondaryAccounts,i=a&&a.length>0,c=i?"ACCOUNT_MANAGEMENT":"ADD_ACCOUNT",o=n?this._getSignoutLinkNode():null,l=this.state.accountsReceived?r.a.createElement(fe,{key:"secondaryAccounts",accounts:a,styles:t,createClickHandler:this._createClickHandler,getUrl:this._getUrl}):null,h=n&&this.props.notifications||null;e=[l,r.a.createElement(Ce,{key:"addAccounts",hasAccounts:i,textId:c,styles:t,manageUrl:this._getUrl("manageUrl"),onClick:this.addAccountsClickHandler}),o],n||(e=r.a.createElement("div",{className:"Mah(0) nr-applet-open_Mah(200px) Ov(h) Trs(menuOpen)"},e));var p=u()("td-applet-account-switch",{"nr-applet-open":!n&&this.state.menuOpen});return r.a.createElement("div",{className:p},s,h,e)},_openMenu:function(e){this.setState({menuOpen:!this.state.menuOpen})},_getUrl:function(e,t,n){var s,a=this.props.componentConfig||{},i=[{}],r=a.urlReplacements||[],c=m()(a,["urls",e],null);return n&&(this.replacements.doneUrl=this._doneUrl()),c&&(c.query&&c.query.forEach(function(e){S.a.isString(e)&&r.hasOwnProperty(e)&&(e=r[e]),i.push(e)}),s=Object.assign({},c,{host:a.host,query:Object.assign.apply(null,i)}),c=T()(s).replace(/\%7B/g,"{").replace(/\%7D/g,"}"),c=(c=(c=this._urlQueryReplace(c,t)).replace(/(\?|&)[A-Za-z0-9_.]+=&/g,"$1")).replace(/(\?|&)[A-Za-z0-9_.]+=$/g,"")),Ee("_getUrl: '",e,"'",c),c},_urlQueryReplace:function(e,t){for(var n,s,a=Object.assign({},this.replacements,t);n=e.match(Re);)n=n[1],s=a.hasOwnProperty(n)&&a[n]||"",e=e.replace(new RegExp("\\{"+n+"\\}","g"),s);return e},_showUserintentManagement:function(){this.executeAction(G.getMutedPublishers,{showManagement:!0})},_getMainAccountNode:function(){var e,t,n,s=this.state.styles,a=this._isDesktop(),i=s.account_switch_main,c=m()(this.props,["componentConfig","user_intent"],!1)&&r.a.createElement(ne.I13nAnchor,{id:"uh-manage-publishers",className:`Mt(10px) Cur(p) ${i.account_info}`,onClick:this._showUserintentManagement,i13nModel:y.a.userintentPublishers},r.a.createElement(le.FormattedMessage,{id:"MANAGE_PUBLISHERS_SHORT"}));if(a){var o=this._getUrl("accountInfo"),l="ACCOUNT_INFO",u=this.UserStore.getAlias();u&&u.match(/@yahoo-inc.com/gi)&&(l="BACKYARD",o="https://backyard.yahoo.com/"),n=o?r.a.createElement(ne.I13nAnchor,{id:"uh-settings",className:i.account_info,href:o,i13nModel:y.a.accountInfo},r.a.createElement(le.FormattedMessage,{id:l})):null}else e=this._openMenu,t=this.state.accountsReceived?r.a.createElement("div",{className:i.arrow_wrapper},r.a.createElement(X.Icon,{asset:te.a,height:"10",color:i.arrow_color,className:i.arrow})):null;return r.a.createElement("div",{className:i.wrapper,onClick:e},r.a.createElement(he,be({useWelcome:!0},this.mainAccount,{styles:s}),t),n,c,this.props.extraAccountInfoComponent)},_updateLink:function(e,t){e&&e.href&&t&&(Ee("_updateLink",e,t),e.href=t)},_createClickHandler:function(e){var t=this,n=R()(function(n){Ee("link clicked!");var s=e(n);t._updateLink(n.currentTarget,s),window.location=n.currentTarget.href},3e3,{leading:!0});return function(e){e.preventDefault(),Ee("preventDefault"),n(e)}},_getSignoutLinkNode:function(){var e=this.state.styles.signed_out,t=this.secondaryAccounts,n=t&&t.length>0?"SIGNOUT_ALL":"SIGNOUT";return r.a.createElement("div",{key:"signout",className:e.wrapper},r.a.createElement(ne.I13nAnchor,{id:"uh-signedout",onClick:this.signoutClickHandler,className:e.content,href:this._getUrl("logoutUrl"),i13nModel:y.a.signout},r.a.createElement(le.FormattedMessage,{id:n})))},_sendRequest:function(){Ee("_sendRequest");var e={requestUrl:this._getUrl("requestUrl")};this.executeAction(Z,e)},getCurrentUrl:function(){var e;if(we){var t=m()(window,["history","state","origUrl"],null);Ee("url from history: ",t),e=t?{url:t}:null}return e||(e=this.RouteStore.getCurrentNavigate()),Ee("getCurrentUrl: ",e),e},_doneUrl:function(){var e=this.getCurrentUrl(),t=this.context.session,n=C(e,t.host,t.protocol);return Ee("pageUrl: ",n),encodeURIComponent(n)},_doneUrlYahoo:function(){var e=this.replacements,t=this.context.session;return m()(this.props,["componentConfig","doneUrlYahoo"],null)||A.a.getLogoUrl(e.intl,t.protocol,null,e.partner)},_isDesktop:function(){return"desktop"===this.context.session.dimensions.device},_getState:function(){var e=this.UHAccountSwitchStore,t=e.getAccountsReceived(),n=!!(this.UserStore.getAlias()||this.ProfileStore.getProfile().nickName||this.UserStore.getFirstName()),s=this.replacements,a=e.getSendRequest(),i=e.getSite(),r=e.getUsers();if(s.crumb=e.getCrumb(),s.doneUrl=this._doneUrl(),s.doneUrlYahoo=this._doneUrlYahoo(),s.site=i,"none"===s.partner&&(s.partner=null),t){if(!this.secondaryAccounts&&r){var c=m()(this.props,["componentConfig","accountListLength"],3);this.mainAccount=r[0],this.secondaryAccounts=r.slice(1,c)}}else this.mainAccount=n?{alias:this.UserStore.getAlias(),fn:this.UserStore.getFirstName()||this.ProfileStore.getProfile().nickName}:null;return{accountsReceived:t,error:e.getError(),mainAccountReceived:!!this.mainAccount,sendRequest:a,isFetching:e.getIsFetching(),menuOpen:!1,site:i}}})};t.controllerViews=Ne;t.meta={dependencies:["tdv2-applet-userintent","tdv2-service-profile"]};const Te={UHAccountSwitchStore:P};t.stores=Te}});